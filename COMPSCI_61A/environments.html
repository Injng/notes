<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-10-19 Sun 13:31 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Environments</title>
<meta name="generator" content="Org Mode" />
<link href="/pagefind/pagefind-ui.css" rel="stylesheet">
                     <script src="/pagefind/pagefind-ui.js"></script>
                     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/default.min.css">
                     <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script>
                     <link rel="stylesheet" href="//unpkg.com/@catppuccin/highlightjs@1.0.1/css/catppuccin-mocha.css">
                     <link rel="stylesheet" href="/style.css" type="text/css"/>
                     <script>hljs.highlightAll();</script>

          <style>
          /* From: https://endlessparentheses.com/public/css/endless.css */
          /* See also: https://meta.superuser.com/questions/4788/css-for-the-new-kbd-style */
          kbd
          {
            -moz-border-radius: 6px;
            -moz-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            -webkit-border-radius: 6px;
            -webkit-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            background-color: #f7f7f7;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            color: #333;
            display: inline-block;
            font-family: 'Droid Sans Mono', monospace;
            font-size: 80%;
            font-weight: normal;
            line-height: inherit;
            margin: 0 .1em;
            padding: .08em .4em;
            text-shadow: 0 1px 0 #fff;
            word-spacing: -4px;
        
            box-shadow: 2px 2px 2px #222; /* MA: An extra I've added. */
          }
          </style>
          <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/tooltipster.bundle.min.css"/>
        
          <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.css" />
        
          <script type="text/javascript">
              if (typeof jQuery == 'undefined') {
                  document.write(unescape('%3Cscript src="https://code.jquery.com/jquery-1.10.0.min.js"%3E%3C/script%3E'));
              }
          </script>
        
           <script type="text/javascript"            src="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/js/tooltipster.bundle.min.js"></script>
        
            <script>
                   $(document).ready(function() {
                       $('.tooltip').tooltipster({
                           theme: 'tooltipster-punk',
                           contentAsHTML: true,
                           animation: 'grow',
                           delay: [100,500],
                           // trigger: 'click'
                           trigger: 'custom',
                           triggerOpen: {
                               mouseenter: true
                           },
                           triggerClose: {
                               originClick: true,
                               scroll: true
                           }
           });
                   });
               </script>
        
          <style>
             abbr {color: red;}
        
             .tooltip { border-bottom: 1px dotted #000;
                        color:red;
                        text-decoration: none;}
          </style>
</head>
<body>
<div id="preamble" class="status">
<div id="search"></div><div class="breadcrumb"><a href="/">Home</a> <span>â†’</span> <a href="/COMPSCI_61A/index.html">COMPSCI 61A</a></div>
</div>
<div id="content" class="content">
<h1 class="title">Environments</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orge8e5342">1. Environments</a>
<ul>
<li><a href="#org9ef1e79">1.1. Multiple Environments</a></li>
</ul>
</li>
<li><a href="#orge456309">2. Environments for Nested Definitions</a></li>
<li><a href="#orgbb17cae">3. Environments for Lambda Expressions</a></li>
<li><a href="#orgea5b610">4. Environments for Sequences</a>
<ul>
<li><a href="#org72259ee">4.1. Box-and-Pointer Notation</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-orge8e5342" class="outline-2">
<h2 id="orge8e5342"><span class="section-number-2">1.</span> Environments</h2>
<div class="outline-text-2" id="text-1">
<p>
Every expression is evaluated in the context of an <b>environment</b>. An environment consists of a sequence of <b>frames</b>, which keeps track of the names bound to values. Every expression is evaluated in the context of an environment.
</p>

<p>
When it comes to assigning frames:
</p>

<ol class="org-ol">
<li>Every <a href="functions.html#orgc7d7ac3">user-defined function</a> has a <i>parent frame</i></li>
<li>The parent of a function is the frame in which it was defined</li>
<li>Every <i>local frame</i> has a <i>parent frame</i></li>
<li>The parent of a frame is the parent of the function called</li>
</ol>

<p>
A name evaluates to the value bound to that name in the <i>earliest frame of the current environment</i> in which that name is found. For example, if we are executing the body of some user-defined function, to look up a name we will first look for that name in the local frame of that function, and then the global frame. Therefore, <i>names have different meanings in different environments</i>.
</p>

<p>
<i>Environment diagrams</i> visualize the interpreter's process. There is code on the left with statements and expressions, with the arrows indicating evaluation order. On the right we have frames, where we keep track of names bound to values:
</p>


<div id="org9269f2d" class="figure">
<p><img src="../static/COMPSCI_61A/functions1.png" alt="functions1.png" />
</p>
</div>
</div>
<div id="outline-container-org9ef1e79" class="outline-3">
<h3 id="org9ef1e79"><span class="section-number-3">1.1.</span> Multiple Environments</h3>
<div class="outline-text-3" id="text-1-1">
<p>
As we mentioned, an environment is a sequence of frames. Specifically, it is either:
</p>

<ol class="org-ol">
<li>The global frame</li>
<li>Local frames, followed by a global frame</li>
</ol>

<p>
Local frames are added to the environment when a <a href="functions.html#org8cd2ae8">user-defined function is called</a>. If another user-defined function is called within that function, there is also the possibility to create yet another environment. For example, in the environment diagram below:
</p>


<div id="org82ab87e" class="figure">
<p><img src="../static/COMPSCI_61A/environments1.png" alt="environments1.png" />
</p>
</div>

<p>
(1) is an environment, but so are both of the environments consisting of (1) and (2) together. Only one of these environments is the active one at any moment, and that is determined based on where the program is executing. For example, if the program is executing within the user-defined function <code>square</code>, then the environment is (1) and (2); otherwise, the environment is the global frame (1).
</p>

<p>
A <code>return</code> statement allows us to bind names in local frames to names in global frames. For example, by returning a value from a function and setting that to a name in the global frame, we can now access that value in the global context.
</p>
</div>
</div>
</div>
<div id="outline-container-orge456309" class="outline-2">
<h2 id="orge456309"><span class="section-number-2">2.</span> Environments for <a href="python.html#orgfff5f96">Nested Definitions</a></h2>
<div class="outline-text-2" id="text-2">
<p>
When we define a function inside of another function, we add a local frame for the inside function that is a parent of the frame for the outside function. For example, for the nested definition:
</p>

<pre><code class="language-python"><span style="color: #cba6f7;">def</span> <span style="color: #89b4fa;">make_adder</span><span style="color: #f38ba8;">(</span>n<span style="color: #f38ba8;">)</span>:
    <span style="color: #cba6f7;">def</span> <span style="color: #89b4fa;">adder</span><span style="color: #f38ba8;">(</span>k<span style="color: #f38ba8;">)</span>:
        <span style="color: #cba6f7;">return</span> k + n
    <span style="color: #cba6f7;">return</span> adder
</code></pre>

<p>
The environment diagram when defining <code>adder</code> is:
</p>


<div id="org356ce54" class="figure">
<p><img src="../static/COMPSCI_61A/environments2.png" alt="environments2.png" />
</p>
</div>

<p>
Now, when we are referencing <code>n</code> inside of <code>adder</code>, the interpreter finds the earliest bound name to <code>n</code>, which is in the frame of <code>make_adder</code>.
</p>

<p>
Note that when we don't have nested definitions, and a function is returning another function inside of it, the frame of the exterior function is <i>not</i> the parent of the <i>interior function</i>. In fact, while we are evaluating the interior function, the environment only consists of the global frame and the frame of that function, which means that local names of the exterior function are <i>not accessible</i> to the interior function in this scenario.
</p>
</div>
</div>
<div id="outline-container-orgbb17cae" class="outline-2">
<h2 id="orgbb17cae"><span class="section-number-2">3.</span> Environments for <a href="expressions.html#org2482cb7">Lambda Expressions</a></h2>
<div class="outline-text-2" id="text-3">
<p>
A lambda function's parent frame is the frame in which the lambda expression was created. In the following example:
</p>

<pre><code class="language-python"><span style="color: #cdd6f4;">a</span> <span style="color: #89dceb;">=</span> 1
<span style="color: #cba6f7;">def</span> <span style="color: #89b4fa;">f</span><span style="color: #f38ba8;">(</span>g<span style="color: #f38ba8;">)</span>:
    <span style="color: #cdd6f4;">a</span> <span style="color: #89dceb;">=</span> 2
    <span style="color: #cba6f7;">return</span> <span style="color: #cba6f7;">lambda</span> y: a * g<span style="color: #f38ba8;">(</span>y<span style="color: #f38ba8;">)</span>
f<span style="color: #f38ba8;">(</span><span style="color: #cba6f7;">lambda</span> y: a + y<span style="color: #f38ba8;">)(</span>a<span style="color: #f38ba8;">)</span>
</code></pre>

<p>
In the last line, the <code>lambda y: a + y</code> is evaluated within the global frame, so the <code>a</code> it refers to within the lambda is <code>a = 1</code>. However, the lambda that is returned within the function <code>f</code> is evaluated within the frame of <code>f</code>, so the <code>a</code> it refers to will instead by <code>a = 2</code>.
</p>
</div>
</div>
<div id="outline-container-orgea5b610" class="outline-2">
<h2 id="orgea5b610"><span class="section-number-2">4.</span> Environments for <a href="sequences.html#orgb4cd23b">Sequences</a></h2>
<div class="outline-text-2" id="text-4">
<p>
It is often hard to represent the environment when there are sequences involved due to the <i>closure property</i>. A method for combining data values satsifies this property if the result of combination can itself be combined using the same method.
</p>

<p>
In other words, this means that, for example, lists can be elements of lists. Closure is powerful because it permits us to create hierarchical structures. However, this also makes representing sequences in environment diagrams hard.
</p>
</div>
<div id="outline-container-org72259ee" class="outline-3">
<h3 id="org72259ee"><span class="section-number-3">4.1.</span> Box-and-Pointer Notation</h3>
<div class="outline-text-3" id="text-4-1">
<p>
To solve this problem, we use <b>box-and-pointer notation</b>. Lists are represented as a row of index-labeled adjacent boxes, one per element. Each box either contains a primitive value or points to another compound value (such as a list):
</p>


<div id="orge0aa075" class="figure">
<p><img src="../static/COMPSCI_61A/environments3.png" alt="environments3.png" />
</p>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<div class="footer">
               <p>Author: Lin Jiang</p>
             </div>
             <div class="last-modified">
               Last modified: 2025-09-23 11:34
             </div><script>
     window.addEventListener('DOMContentLoaded', (event) => {
         new PagefindUI({
            element: '#search',
            showSubResults: true,
            bundlePath: '/pagefind/'
         });
     });
    </script>
</div>
</body>
</html>
