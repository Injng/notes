<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-11-03 Mon 13:33 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Orthogonality</title>
<meta name="generator" content="Org Mode" />
<link href="/pagefind/pagefind-ui.css" rel="stylesheet">
                     <script src="/pagefind/pagefind-ui.js"></script>
                     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/default.min.css">
                     <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script>
                     <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/scheme.min.js"></script
                     <link rel="stylesheet" href="//unpkg.com/@catppuccin/highlightjs@1.0.1/css/catppuccin-frappe.css">
                     <link rel="stylesheet" href="/style.css" type="text/css"/>
                     <script>hljs.highlightAll();</script>

          <style>
          /* From: https://endlessparentheses.com/public/css/endless.css */
          /* See also: https://meta.superuser.com/questions/4788/css-for-the-new-kbd-style */
          kbd
          {
            -moz-border-radius: 6px;
            -moz-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            -webkit-border-radius: 6px;
            -webkit-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            background-color: #f7f7f7;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            color: #333;
            display: inline-block;
            font-family: 'Droid Sans Mono', monospace;
            font-size: 80%;
            font-weight: normal;
            line-height: inherit;
            margin: 0 .1em;
            padding: .08em .4em;
            text-shadow: 0 1px 0 #fff;
            word-spacing: -4px;
        
            box-shadow: 2px 2px 2px #222; /* MA: An extra I've added. */
          }
          </style>
          <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/tooltipster.bundle.min.css"/>
        
          <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.css" />
        
          <script type="text/javascript">
              if (typeof jQuery == 'undefined') {
                  document.write(unescape('%3Cscript src="https://code.jquery.com/jquery-1.10.0.min.js"%3E%3C/script%3E'));
              }
          </script>
        
           <script type="text/javascript"            src="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/js/tooltipster.bundle.min.js"></script>
        
            <script>
                   $(document).ready(function() {
                       $('.tooltip').tooltipster({
                           theme: 'tooltipster-punk',
                           contentAsHTML: true,
                           animation: 'grow',
                           delay: [100,500],
                           // trigger: 'click'
                           trigger: 'custom',
                           triggerOpen: {
                               mouseenter: true
                           },
                           triggerClose: {
                               originClick: true,
                               scroll: true
                           }
           });
                   });
               </script>
        
          <style>
             abbr {color: red;}
        
             .tooltip { border-bottom: 1px dotted #000;
                        color:red;
                        text-decoration: none;}
          </style>
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="preamble" class="status">
<div id="search"></div><div class="breadcrumb"><a href="/">Home</a> <span>→</span> <a href="/MATH_54/index.html">MATH 54</a></div>
</div>
<div id="content" class="content">
<h1 class="title">Orthogonality</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org7c3c9bf">1. Orthogonality</a>
<ul>
<li><a href="#org896014c">1.1. Orthogonal Sets</a></li>
<li><a href="#orgb99d133">1.2. Orthogonal Basis</a></li>
<li><a href="#orgd94c2b7">1.3. Orthogonal Matrices</a>
<ul>
<li><a href="#org3fff8f1">1.3.1. Orthonormal Basis</a></li>
</ul>
</li>
<li><a href="#org5524508">1.4. Orthogonal Projections</a>
<ul>
<li><a href="#org07078f0">1.4.1. With Orthonormal Basis</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org28517a4">2. Gram-Schmidt Process</a></li>
<li><a href="#org5687972">3. QR Factorization</a></li>
</ul>
</div>
</div>
<div id="outline-container-org7c3c9bf" class="outline-2">
<h2 id="org7c3c9bf"><span class="section-number-2">1.</span> Orthogonality</h2>
<div class="outline-text-2" id="text-1">
<p>
Two vectors \(\mathbf{u}\) and \(\mathbf{v}\) are called <b>orthogonal</b> when \(\mathbf{u} \cdot \mathbf{v} = 0\), or when the <b>norm</b> (magnitude) of the two vectors satisfies the famous rule of Pythagoras: \(\left | \mathbf{u} \right |^2 + \left | \mathbf{v} \right |^2 = \left | \mathbf{u} + \mathbf{v} \right |^2\).
</p>

<p>
More broadly, we can say that if \(\mathbf{v} \in \mathbb{R}^n\), and \(W\) is a subspace of \(\mathbb{R}^n\), that \(\mathbf{v}\) is orthogonal to \(W\) if it is orthogonal to <i>every vector in</i> \(W\). We call \(W^{\perp}\) the <b>orthogonal complement</b> of \(W\), consisting of all the vectors orthogonal to \(W\).
</p>

<p>
An important application of orthogonality comes in the form of <a href="vector_spaces.html#orgb2107ea">vector spaces</a>. We can say that the <a href="vector_spaces.html#org9540b6b">row space</a> of \(A\) is orthogonal to the <a href="vector_spaces.html#org19f8b6b">nullspace</a> of \(A\):
</p>

\begin{align}
(\text{Row }A)^{\perp} = \text{Nul }A
\end{align}

<p>
This is because by the definition of the nullspace, vectors in the nullspace, when multiplied by vectors in the row space, yield the zero vector. Similarly:
</p>

\begin{align}
(\text{Col }A)^{\perp}= \text{Nul } (A^T)
\end{align}

<p>
Given \(W\) a susbpace of \(\mathbb{R}^n\), we can then use (1) to find \(W^{\perp}\). If \(W\) has \(m\) vectors as its basis, we can write the basis elements of \(W\) as the rows of an \(m \times n\) matrix \(A\). Then, \(W^{\perp}\) is just the nullspace of \(A\).
</p>
</div>
<div id="outline-container-org896014c" class="outline-3">
<h3 id="org896014c"><span class="section-number-3">1.1.</span> Orthogonal Sets</h3>
<div class="outline-text-3" id="text-1-1">
<p>
An <b>orthogonal set</b> is a set of vectors in which every pair of distinct vectors are orthogonal.
</p>

<p>
We can say that an orthogonal set of nonzero vectors \(\{\mathbf{u}_1, \dots , \mathbf{u}_n\}\) <i>is always linearly independent</i>. We can prove this by contradiction — say that it is not linearly independent, and then:
</p>

\begin{align}
\mathbf{u}_n &= c_1\mathbf{u}_1 + c_2\mathbf{u}_2 + \cdots + \mathbf{c}_{n-1}\mathbf{u}_{n-1} \notag \\
\mathbf{u}_n \cdot \mathbf{u}_n &= c_1\mathbf{u}_1 \cdot \mathbf{u}_n + c_2\mathbf{u}_2 \cdot \mathbf{u}_n + \cdots + c_{n-1}\mathbf{u}_{n-1}\cdot \mathbf{u}_{n} \notag \\
\mathbf{u}_n \cdot \mathbf{u}_n &= 0 \notag
\end{align}

<p>
However, this is a contradiction since the only way for \(\mathbf{u}_n \cdot \mathbf{u}_n = 0\) is if \(\mathbf{u}_n=0\), which is not allowed as this is a set of nonzero vectors. Therefore, they must all be linearly independent.
</p>
</div>
</div>
<div id="outline-container-orgb99d133" class="outline-3">
<h3 id="orgb99d133"><span class="section-number-3">1.2.</span> Orthogonal Basis</h3>
<div class="outline-text-3" id="text-1-2">
<p>
In a vector space \(V\), an <b>orthogonal basis</b> is a basis for \(V\) that is an orthogonal set.
</p>

<p>
If \(\{\mathbf{u}_1, \mathbf{u}_2, \dots ,\mathbf{u}_n\}\) is an orthogonal basis for a vector space \(V\), and we want to write for some \(\mathbf{y} \in V\) as a linear combination of the elements in the orthogonal basis:
</p>

\begin{align}
y = c_1\mathbf{u}_1 + c_2\mathbf{u}_2 + \cdots + c_n\mathbf{u}_n \notag
\end{align}

<p>
Since the basis is orthogonal, we have a shortcut:
</p>

\begin{align}
\boxed{c_j = \frac{\mathbf{y} \cdot \mathbf{u}_j}{\mathbf{u}_j \cdot \mathbf{u}_j} \; \forall \: 1 \leq j \leq n}
\end{align}

<p>
We can see that this works if we multiply our original equation by \(\mathbf{u}_j\) on both sides. We then have \(\mathbf{y} \cdot \mathbf{u}_j = 0 + \cdots + c_j \mathbf{u}_j \cdot \mathbf{u}_j + \cdots + 0\), which simplifies to (3) if we isolate \(\mathbf{c}_j\).
</p>
</div>
</div>
<div id="outline-container-orgd94c2b7" class="outline-3">
<h3 id="orgd94c2b7"><span class="section-number-3">1.3.</span> Orthogonal Matrices</h3>
<div class="outline-text-3" id="text-1-3">
<p>
A set or basis in some subspace of \(\mathbb{R}^n\) is an <b>orthonormal</b> set or basis if it is an orthogonal set in which every vector has length \(1\). We can switch from orthogonal to orthonormal by dividing each vector by its magnitude.
</p>

<p>
A real square matrix is an <b>orthogonal matrix</b> if it has <i>orthonormal columns</i>. Such a matrix \(U\) must satisfy \(U^TU = I\), or \(U^T\) is the inverse of \(U\). Additionally, if \(U\) and \(V\) are orthogonal, then \(UV\) is also orthogonal since \((UV)^T = V^TU^T = V^{-1}U^{-1} = (UV)^{-1}\).
</p>

<p>
One interesting fact is that if we have any \(m \times n\) orthogonal matrix \(U\), for any \(\mathbf{x} \in \mathbb{R}^n\) we have:
</p>

\begin{align}
\left | U\mathbf{x} \right | = \left | \mathbf{x} \right |
\end{align}

<p>
In other words, multiplying \(\mathbf{x}\) by an orthogonal matrix doesn't change its length even if \(U\mathbf{x}\) is in a different dimension than \(\mathbf{x}\).
</p>
</div>
<div id="outline-container-org3fff8f1" class="outline-4">
<h4 id="org3fff8f1"><span class="section-number-4">1.3.1.</span> Orthonormal Basis</h4>
<div class="outline-text-4" id="text-1-3-1">
<p>
An orthonormal basis is convenient to change into. If we have an orthonormal basis \(\mathcal{B}\) with vectors \(\{\mathbf{u}_1, \mathbf{u}_2, \dots , \mathbf{u}_n\}\), and since the inverse of the change of basis matrix \(P_{\mathcal{B}}^{-1}\) is equal to \(P_{\mathcal{B}}^T\), then:
</p>

\begin{align}
[\mathbf{x}]_{\mathcal{B}} = P_{\mathcal{B}}^{-1}\mathbf{x} = P_{\mathcal{B}}^T\mathbf{x} = \begin{bmatrix} \mathbf{u}_1 \cdot \mathbf{x} \\ \mathbf{u}_2 \cdot \mathbf{x} \\ \vdots \\ \mathbf{u}_n \cdot \mathbf{x}\end{bmatrix} \notag
\end{align}
</div>
</div>
</div>
<div id="outline-container-org5524508" class="outline-3">
<h3 id="org5524508"><span class="section-number-3">1.4.</span> Orthogonal Projections</h3>
<div class="outline-text-3" id="text-1-4">
<p>
Say we want to find the projection of some vector \(\mathbf{y}\) on some subspace \(W\). Call this projection \(\mathbf{\hat{y}}\); then, we can express \(\mathbf{y}\) as the sum of this projection with some other vector \(\mathbf{z}\):
</p>

\begin{align}
\mathbf{y} = \mathbf{\hat{y}} + \mathbf{z}
\end{align}

<p>
where \(\mathbf{\hat{y}} \in W\) and \(\mathbf{z} \in W^{\perp}\). We can intuitively understand that this works for a certain dimension:
</p>


<div id="orge0f84a7" class="figure">
<p><img src="../static/MATH_54/orthogonality1.png" alt="orthogonality1.png" />
</p>
</div>

<p>
To find \(\mathbf{\hat{y}}\), we consider an orthogonal basis \(\{\mathbf{u}_1, \mathbf{u}_2, \dots ,\mathbf{u}_n\}\). We know that the dot product of a vector and a unit vector is the <a href="Multivariable_Calculus/vectors.html#org6d304fb">projection</a> of that vector in the direction of the unit vector. For the projection along a non-unit vector, then, we must divide by the magnitude:
</p>

\begin{align}
(\mathbf{y} \cdot \mathbf{\hat{u}}_i) \mathbf{\hat{u}}_i = \left(\frac{\mathbf{y} \cdot \mathbf{u}_i}{\left|\mathbf{u}_i\right|}\right)\frac{\mathbf{u}_i}{\left|\mathbf{u}_i\right|} = \frac{\mathbf{y} \cdot \mathbf{u}_i}{\left|\mathbf{u}_i\right|\left|\mathbf{u}_i\right|} \mathbf{u}_i = \frac{\mathbf{y} \cdot \mathbf{u}_i}{\mathbf{u}_i \cdot \mathbf{u}_i} \mathbf{u}_i \notag
\end{align}

<p>
The total projection onto \(W\) is the vector sum of all the projections onto each of these basis vectors:
</p>

\begin{align}
\boxed{\mathbf{\hat{y}} = \sum_{i = 1}^{n} \frac{\mathbf{y} \cdot \mathbf{u}_i}{\mathbf{u}_i \cdot \mathbf{u}_i} \mathbf{u}_i}
\end{align}
</div>
<div id="outline-container-org07078f0" class="outline-4">
<h4 id="org07078f0"><span class="section-number-4">1.4.1.</span> With Orthonormal Basis</h4>
<div class="outline-text-4" id="text-1-4-1">
<p>
If we have an orthonormal basis \(\{ \mathbf{u}_1, \mathbf{u}_2, \dots , \mathbf{u}_k \}\) for W, then we can just directly take the dot product of \(y\) with each of the basis vectors to obtain the projection of \(y\) onto each basis vector (since they are unit vectors). We can write \(\hat{y}\) as:
</p>

\begin{align}
\mathbf{\hat{y}} = \begin{bmatrix} \: \\ \mathbf{u}_1 & \mathbf{u}_2 & \cdots & \mathbf{u}_k \\ \: 
\end{bmatrix}
\begin{bmatrix} \mathbf{y} \cdot \mathbf{u}_1 \\ \mathbf{y} \cdot \mathbf{u}_2 \\ \vdots \\ \mathbf{y} \cdot \mathbf{u}_k\end{bmatrix} \notag
\end{align}

<p>
If we call the matrix \(U\) the matrix whose columns are the basis vectors, then we can write this as:
</p>

\begin{align}
\boxed{\mathbf{\hat{y}} = UU^T\mathbf{y}}
\end{align}
</div>
</div>
</div>
</div>
<div id="outline-container-org28517a4" class="outline-2">
<h2 id="org28517a4"><span class="section-number-2">2.</span> Gram-Schmidt Process</h2>
<div class="outline-text-2" id="text-2">
<p>
Since projections only work for an orthogonal basis, there comes an issue when we are given a basis that is not orthogonal, yet we still want to find the projection. Thus, we need the <b>Gram-Schmidt process</b> to turn an arbitrary basis for \(W\), \(\{\mathbf{x}_1, \mathbf{x}_2, \dots , \mathbf{x}_k\}\), into an orthogonal basis \(\{\mathbf{q}_1, \mathbf{q}_2, \dots, \mathbf{q}_k\}\).
</p>

<p>
First, we take:
</p>

\begin{align}
\mathbf{q}_1 = \mathbf{x}_1 \notag
\end{align}

<p>
Then, we want the \(\mathbf{q}_2\) to be perpendicular to \(\mathbf{q}_1\). To do this, we start with \(\mathbf{x}_2\) and subtract its projection along \(\mathbf{q}_1\) — this gives us a vector perpendicular to \(\mathbf{q}_1\):
</p>

\begin{align}
\mathbf{q}_2 = \mathbf{x}_2 - \frac{\mathbf{x}_2 \cdot \mathbf{q}_1}{\mathbf{q}_1 \cdot \mathbf{q}_1}\mathbf{q}_1 \notag
\end{align}

<p>
Now, \(\{\mathbf{q}_1, \mathbf{q}_2\}\) has the same span as \(\{\mathbf{q}_1, \mathbf{q}_2\}\), but now \(\mathbf{q}_1\) and \(\mathbf{q}_2\) are orthogonal. We can proceed with \(\mathbf{q}_3\), taking \(\mathbf{x}_3\) and subtracting from it its projection on the subspace defined by \(\{\mathbf{q}_1, \mathbf{q}_2\}\):
</p>

\begin{align}
\mathbf{q}_3 = \mathbf{x}_3 - \frac{\mathbf{x}_3 \cdot \mathbf{q}_1}{\mathbf{q}_1 \cdot \mathbf{q}_1}\mathbf{q}_1 - \frac{\mathbf{x}_3 \cdot \mathbf{q}_2}{\mathbf{q}_2 \cdot \mathbf{q}_2}\mathbf{q}_2 \notag
\end{align}

<p>
This is the central idea to Gram-Schmidt: <i>subtract from every new vector its projections in the directions already set</i>. In general, we have:
</p>

\begin{align}
\boxed{\mathbf{q}_k = \mathbf{x}_k - \sum_{i = 1}^{k-1} \frac{\mathbf{x}_k \cdot \mathbf{q}_i}{\mathbf{q}_i \cdot \mathbf{q}_i}\mathbf{q}_i}
\end{align}

<p>
Usefully, the space spanned by the first \(j\) vectors in the new orthogonal basis is the same as the span of the first \(j\) vectors in the original basis.
</p>
</div>
</div>
<div id="outline-container-org5687972" class="outline-2">
<h2 id="org5687972"><span class="section-number-2">3.</span> QR Factorization</h2>
<div class="outline-text-2" id="text-3">
<p>
In Gram-Schmidt, we started with some arbitrary basis, and ended with another basis that spans the same space but is orthogonal. If the starting basis is represented by the linearly independent columns of some \(m \times n\) matrix \(A\), and the transformed orthogonal basis is the matrix \(Q\), then since the columns of \(A\) can be formed from linear combinations of \(Q\), there must be some other matrix connecting the two.
</p>

<p>
This other matrix is an \(n \times n\) upper triangular matrix \(R\) such that we can factorize \(A\) as:
</p>

\begin{align}
\boxed{A = QR}
\end{align}

<p>
We know that \(R\) has to be upper triangular because in Gram-Schmidt, at every step \(\mathbf{x}_k\) can be expressed as a linear combination of only \(\mathbf{q}_1, \mathbf{q}_2, \dots, \mathbf{q}_k\). Later vectors of \(\mathbf{q}\) are not involved. Thus, we can say that for each \(q \leq k \leq n\):
</p>

\begin{align}
\mathbf{x}_k = r_{1k}\mathbf{q}_1 + r_{2j}\mathbf{q}_2 + \cdots + r_{kk}\mathbf{q}_k + 0\cdot \mathbf{q}_{k + 1} + \cdots + 0 \cdot \mathbf{q}_n \notag
\end{align}

<p>
Then, \(R\) can be represented as:
</p>

\begin{align}
R = \begin{bmatrix} r_{11} & r_{12} & \cdots & r_{1n} \\ 0 & \ddots \\ \vdots & & & r_{nn}\end{bmatrix} \notag
\end{align}

<p>
Thus, \(R\) must be upper triangular.
</p>

<p>
To find the \(QR\) factorization of some matrix \(A\) with linearly independent columns, we can first find \(Q\) by using Gram-Schmidt on the columns of \(A\) and then normalizing them. For \(R\), since \(Q\) has orthonormal columns, \(Q^TQ=I\), so:
</p>

\begin{align}
A &= QR \notag \\
Q^TA &= IR \notag \\
R &= Q^TA
\end{align}
</div>
</div>
</div>
<div id="postamble" class="status">
<div class="footer">
               <p>Author: Lin Jiang</p>
             </div>
             <div class="last-modified">
               Last modified: 2025-10-29 10:25
             </div><script>
     window.addEventListener('DOMContentLoaded', (event) => {
         new PagefindUI({
            element: '#search',
            showSubResults: true,
            bundlePath: '/pagefind/'
         });
     });
    </script>
</div>
</body>
</html>
